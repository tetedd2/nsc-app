<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üìù ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‚Äì MoneySkillz</title>
  <style>
    /* ... (CSS ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô) ... */
    body { font-family: 'Segoe UI', sans-serif; background: #f0f9f9; margin: 0; }
    .container { max-width: 700px; margin: 32px auto; background: #fff; border-radius: 18px; box-shadow: 0 8px 24px #00968822; padding: 32px 20px; }
    h1, h2 { text-align: center; color: #00796b; }
    .set-list { display: flex; flex-wrap: wrap; gap: 18px; justify-content: center; margin-bottom: 20px; }
    .set-btn { padding: 18px 30px; border-radius: 10px; background: #009688; color: #fff; border: none; font-size: 1.1rem; cursor: pointer; transition: background 0.18s; }
    .set-btn:hover { background: #00796b; }
    .quiz-box { margin: 0 auto; max-width: 520px; }
    .question { font-size: 1.13rem; margin-bottom: 18px; color: #333; }
    .choices { list-style: none; padding: 0; }
    .choices li { background: #e0f2f1; margin-bottom: 10px; padding: 12px 16px; border-radius: 8px; cursor: pointer; transition: background 0.15s; border: 2px solid transparent; }
    .choices li:hover { background: #b2dfdb; }
    .choices li.selected { border-color: #009688; }
    .choices li.disabled { pointer-events: none; opacity: 0.72; }
    .explain { margin: 14px 0 0 0; color: #1565c0; font-size: 1rem; min-height: 28px; }
    .next-btn, .finish-btn { margin: 22px auto 0; display: block; background: #009688; color: #fff; padding: 10px 28px; border-radius: 20px; border: none; font-size: 1.07rem; cursor: pointer; transition: background 0.15s; }
    .next-btn:hover, .finish-btn:hover { background: #00796b; }
    .score-box { text-align: center; margin-top: 30px; }
    .score-box span { color: #388e3c; font-size: 1.8rem; font-weight: bold; }
    .back-btn { margin: 28px auto 0; background: #bdbdbd; color: #333; border: none; border-radius: 18px; padding: 10px 24px; font-size: 1rem; display: block; cursor: pointer; transition: background 0.14s; }
    .back-btn:hover { background: #757575; color: #fff; }
    .history-section { margin-top: 36px; }
    .history-title { font-size:1.12rem; color:#00796b; margin-bottom:10px; }
    .history-list { list-style:none; padding:0; }
    .history-list li { background:#e0f7fa; border-radius:9px; margin:6px 0; padding:10px 13px; font-size:1rem; }
  </style>
  <!-- Firebase SDK + config -->
  <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-auth.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBW_6zxU1RUfjsAkv2cXEek21jCk_Muy_0",
      authDomain: "financial-management-app-f6444.firebaseapp.com",
      projectId: "financial-management-app-f6444",
      storageBucket: "financial-management-app-f6444.appspot.com",
      messagingSenderId: "1076541981473",
      appId: "1:1076541981473:web:b87f5de9e6c78608673460",
      measurementId: "G-74HS8JK0SC"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
</head>
<body>
  <div class="container">
    <h1>üìù ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h1>
    <div id="start-section">
      <h2>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h2>
      <div class="set-list">
        <button class="set-btn" onclick="startSet(1)">‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1: ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</button>
        <button class="set-btn" onclick="startSet(2)">‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2: ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</button>
        <button class="set-btn" onclick="startSet(3)">‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 3: ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</button>
      </div>
    </div>
    <div id="quiz-section" style="display:none;">
      <div class="quiz-box">
        <div class="question" id="question"></div>
        <ul class="choices" id="choices"></ul>
        <div class="explain" id="explain"></div>
        <button class="next-btn" id="nextBtn" style="display:none;">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        <button class="finish-btn" id="finishBtn" style="display:none;">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
      </div>
    </div>
    <div id="score-section" style="display:none;">
      <div class="score-box">
        <h2>‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h2>
        <p>‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ <span id="score"></span> ‡∏à‡∏≤‡∏Å <span id="total"></span> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
        <div id="scoreMsg"></div>
        <button class="back-btn" onclick="window.location.reload()">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡πÉ‡∏´‡∏°‡πà</button>
      </div>
      <div class="history-section" id="history-section" style="display:none;">
        <div class="history-title">‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
        <ul class="history-list" id="historyList"></ul>
      </div>
    </div>
  </div>
  <script>
    // ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏∏‡∏î (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
    const sets = {
      1: [
        {
          q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏≤?",
          c: ["‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ", "‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏≠‡∏°‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô", "‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô", "‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô"],
          a: 1,
          explain: "‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏õ‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï"
        },
        {
          q: "‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ 600 ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô 400 ‡∏ö‡∏≤‡∏ó ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?",
          c: ["‡∏Ç‡∏≠‡∏¢‡∏∑‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô", "‡∏≠‡∏î‡πÉ‡∏à‡∏£‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°", "‡∏£‡∏π‡∏î‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï", "‡∏Ç‡πÇ‡∏°‡∏¢‡∏Ç‡∏≠‡∏á"],
          a: 1,
          explain: "‡∏Ñ‡∏ß‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏î‡∏ó‡∏ô‡∏£‡∏≠ ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ã‡∏∑‡πâ‡∏≠ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏µ‡πâ"
        },
        {
          q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô?",
          c: ["‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô", "‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô", "‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏°‡∏´‡∏ß‡∏≤‡∏ô", "‡∏Ñ‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô"],
          a: 1,
          explain: "‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πà‡∏≠‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô"
        }
      ],
      2: [
        {
          q: "‡∏Å‡∏≤‡∏£‡∏à‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?",
          c: ["‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏ß‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô", "‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏õ‡πÑ‡∏´‡∏ô", "‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤", "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå"],
          a: 1,
          explain: "‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏£‡∏á‡∏à‡∏∏‡∏î‡πÑ‡∏´‡∏ô"
        },
        {
          q: "‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô 1,000 ‡∏ö‡∏≤‡∏ó ‡∏≠‡∏¢‡∏≤‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà 1,200 ‡∏ö‡∏≤‡∏ó ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?",
          c: ["‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ", "‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏û‡∏≠", "‡∏¢‡∏∑‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô", "‡∏ã‡∏∑‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô ‡∏Ñ‡πà‡∏≠‡∏¢‡∏´‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á"],
          a: 1,
          explain: "‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏û‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ã‡∏∑‡πâ‡∏≠ ‡∏ä‡πà‡∏ß‡∏¢‡∏ù‡∏∂‡∏Å‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡∏µ‡πâ"
        }
      ],
      3: [
        {
          q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°?",
          c: ["‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ", "‡∏≠‡∏≠‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏´‡∏•‡∏∑‡∏≠", "‡πÉ‡∏ä‡πâ‡∏à‡∏ô‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏≠‡∏≠‡∏°", "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡∏°"],
          a: 0,
          explain: "‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß"
        },
        {
          q: "‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÉ‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?",
          c: ["‡∏´‡∏∏‡πâ‡∏ô", "‡∏ù‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå", "‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥", "‡∏™‡∏•‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡πÅ‡∏ö‡πà‡∏á"],
          a: 1,
          explain: "‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô"
        }
      ]
    };
    let set = [], setTotal = 0, idx = 0, score = 0, setId = 1;

    function startSet(id) {
      setId = id;
      set = sets[setId];
      setTotal = set.length;
      idx = 0;
      score = 0;
      document.getElementById('start-section').style.display = "none";
      document.getElementById('score-section').style.display = "none";
      document.getElementById('quiz-section').style.display = "block";
      showQ();
    }

    function showQ() {
      const q = set[idx];
      document.getElementById('question').textContent = `‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${idx + 1}: ${q.q}`;
      const choicesEl = document.getElementById('choices');
      choicesEl.innerHTML = '';
      document.getElementById('explain').textContent = '';
      document.getElementById('nextBtn').style.display = 'none';
      document.getElementById('finishBtn').style.display = 'none';
      q.c.forEach((choice, i) => {
        const li = document.createElement('li');
        li.textContent = choice;
        li.onclick = () => select(i, li);
        choicesEl.appendChild(li);
      });
    }

    function select(i, li) {
      const q = set[idx];
      // Lock choices
      document.querySelectorAll('#choices li').forEach(el => {
        el.classList.add('disabled');
        el.onclick = null;
      });
      li.classList.add('selected');
      let explainEl = document.getElementById('explain');
      if(i === q.a) {
        score++;
        explainEl.innerHTML = `‚úÖ <b>‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!</b> ${q.explain}`;
        explainEl.style.color = "#388e3c";
      } else {
        explainEl.innerHTML = `‚ùå <b>‡∏ú‡∏¥‡∏î</b> ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠ "${q.c[q.a]}"<br>${q.explain}`;
        explainEl.style.color = "#c62828";
      }
      // Show next/finish button
      if (idx < setTotal - 1) {
        document.getElementById('nextBtn').style.display = 'block';
        document.getElementById('nextBtn').onclick = nextQ;
      } else {
        document.getElementById('finishBtn').style.display = 'block';
        document.getElementById('finishBtn').onclick = showScore;
      }
    }

    function nextQ() {
      idx++;
      showQ();
    }

    function showScore() {
      document.getElementById('quiz-section').style.display = 'none';
      document.getElementById('score-section').style.display = 'block';
      document.getElementById('score').textContent = score;
      document.getElementById('total').textContent = setTotal;
      let msg = '';
      const percent = (score / setTotal) * 100;
      if(percent >= 90) msg = "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡∏µ‡∏°‡∏≤‡∏Å üëç";
      else if(percent >= 70) msg = "‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏î‡∏µ";
      else if(percent >= 50) msg = "‡∏û‡∏≠‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ ‡∏•‡∏≠‡∏á‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°";
      else msg = "‡∏Ñ‡∏ß‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö";
      document.getElementById('scoreMsg').textContent = msg;

      // üî• ‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô quiz ‡∏•‡∏á Firestore
      firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
          db.collection("users").doc(user.uid).collection("quiz-results").add({
            set: setId,
            score: score,
            total: setTotal,
            percent: percent,
            date: new Date().toISOString()
          });
          // ‡πÇ‡∏´‡∏•‡∏î‡∏ú‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
          loadQuizHistory(user.uid);
        }
      });
    }

    // ‡∏î‡∏∂‡∏á‡∏ú‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á (score history)
    function loadQuizHistory(uid) {
      db.collection("users").doc(uid).collection("quiz-results")
        .orderBy("date", "desc")
        .limit(5)
        .get()
        .then(snapshot => {
          const section = document.getElementById('history-section');
          const list = document.getElementById('historyList');
          list.innerHTML = "";
          let hasHistory = false;
          snapshot.forEach(doc => {
            const d = doc.data();
            hasHistory = true;
            list.innerHTML += `<li>
              <b>‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà ${d.set}</b> | ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <b>${d.score}</b> / ${d.total} (${d.percent.toFixed(0)}%)
              <br>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${new Date(d.date).toLocaleString("th-TH", { year:'numeric', month:'short', day:'numeric', hour:'2-digit', minute:'2-digit' })}
            </li>`;
          });
          section.style.display = hasHistory ? "block" : "none";
        });
    }
  </script>
</body>
</html>
